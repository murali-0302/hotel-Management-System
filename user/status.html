<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hotel HMS | Booking Status</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/status.css"

</head>

<body>

<button id="menuBtn" class="hamburger">
  <span></span>
  <span></span>
  <span></span>
</button>

<!-- OVERLAY -->
<div id="overlay"></div>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebarPanel">
  <h2>Hotel HMS</h2>
  <a href="booking.html" class="active">Bookings</a>
  <a href="status.html">Status</a>
  <a href="login.html">Logout</a>
</div>

  <!-- MAIN -->
  <div class="main">
    <h1>Booking Status</h1>
    <div id="statusList"></div>
  </div>
<script src="../js/sidebar.js"></script>
<script>
  const statusList = document.getElementById("statusList");
  let bookings = JSON.parse(localStorage.getItem("bookings")) || [];

  if (bookings.length === 0) {
    statusList.innerHTML = "<p>No bookings found.</p>";
  }

  function renderBookings() {
    statusList.innerHTML = "";

    bookings.forEach((b, index) => {
      const statusClass =
        b.status === "Approved" ? "approved" :
        b.status === "Rejected" ? "rejected" : "pending";

      statusList.innerHTML += `
        <div class="card">
          <div class="row"><span class="label">Guest</span><span class="value">${b.guestName}</span></div>
          <div class="row"><span class="label">Room</span><span class="value">${b.roomNumber}</span></div>
          <div class="row"><span class="label">Check-In</span><span class="value">${b.checkIn || "-"}</span></div>
          <div class="row"><span class="label">Check-Out</span><span class="value">${b.checkOut || "-"}</span></div>
          <div class="row"><span class="label">Payment</span><span class="value">${b.paymentMethod} - ₹${b.amount}</span></div>
          <div class="row"><span class="label">Status</span><span class="status ${statusClass}">${b.status || "Pending"}</span></div>

          <div class="actions">
            <button class="btn delete" onclick="deleteBooking(${index})">Delete</button>
            <button class="btn download" onclick="downloadBooking(${index})">Download</button>
          </div>
        </div>
      `;
    });
  }

  function deleteBooking(index) {
    if (!confirm("Delete this booking?")) return;
    bookings.splice(index, 1);
    localStorage.setItem("bookings", JSON.stringify(bookings));
    renderBookings();
  }

  function downloadBooking(index) {
    const b = bookings[index];

    const content = `
Hotel HMS - Booking Status

Guest Name : ${b.guestName}
Room Number: ${b.roomNumber}
Check-In   : ${b.checkIn}
Check-Out  : ${b.checkOut}
Payment    : ${b.paymentMethod} - ₹${b.amount}
Status     : ${b.status || "Pending"}

Thank you for booking with us!
`;

    const blob = new Blob([content], { type: "text/plain" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = `Room_${b.roomNumber}_Booking.txt`;
    link.click();
  }

  renderBookings();
</script>

</body>
</html>
